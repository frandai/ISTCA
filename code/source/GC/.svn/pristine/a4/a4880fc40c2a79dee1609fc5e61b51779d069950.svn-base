<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{personaGestion.modoAlta? 'Nueva' : 'Gestión'} persona"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <c:if test="#{personaGestion.esRepNoEx}">
                <p style="text-align: center;" class="valor">No puede editar esta persona.</p>
            </c:if>
            <c:if test="#{not personaGestion.esRepNoEx}">
                <p:fieldset collapsed="#{personaGestion.borrado}" legend="Datos de la Persona" styleClass="campoRellena" id="datosPersona" toggleable="true">
                    <div style="float: right; min-width: 440px;">
                        <div>
                            <p:selectBooleanButton rendered="#{sesionActual.tienePermiso(4)}" style="float: right; margin: 0px 5px;" onLabel="Masculino" offLabel="Femenino" value="#{personaGestion.personaSeleccionada.masculino}">
                                <f:ajax />
                            </p:selectBooleanButton>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" style="float: right; margin: 0px 5px;" value="#{personaGestion.personaSeleccionada.masculino?'Masculino':'Femenino'}"/>
                            <p:selectBooleanButton 
                                rendered="#{empty personaGestion.personaSeleccionada.alumno.matriculaList and sesionActual.tienePermiso(4)}"
                                style="float: right; margin: 0px 5px;" onLabel="Alumno" offLabel="No es Alumno" value="#{personaGestion.esAlumno}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" style="float: right; margin: 0px 5px;" value="#{personaGestion.esAlumno?'Es Alumno':''}"/>
                            <p:selectBooleanButton
                                rendered="#{empty personaGestion.personaSeleccionada.tutor.tutoriaHorarioList and sesionActual.tienePermiso(4)}"
                                style="float: right; margin: 0px 5px;" onLabel="Tutor" offLabel="No es Tutor" value="#{personaGestion.esTutor}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" style="float: right; margin: 0px 5px;" value="#{personaGestion.esTutor?'Es Tutor':''}"/>
                        </div>
                    </div>
                    <div>
                        <h:outputLabel value="NIF:"/>
                        <p:inputText validator="#{validarVista.validaNIF}" rendered="#{sesionActual.tienePermiso(4)}" id="nif_persona" styleClass="valor" value="#{personaGestion.personaSeleccionada.nif}" required="true" label="NIF" >
                            <f:ajax  event="blur" render="nif_persona nif1 nif2"/> 
                        </p:inputText>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.nif}"/>
                        <h:outputLabel id="nif1" value="(#{personaGestion.personaSeleccionada.tipoNif})" style="width: auto; text-align: left; margin: 10px;"/>
                        <!--#-{personaGestion.personaSeleccionada.tipoNif eq '-'?'':'display:none;'}-->
                        <p:selectBooleanButton id="nif2" style="display:none;" value="#{personaGestion.nifGenerado}" rendered="#{sesionActual.tienePermiso(4)}" onLabel="Generado automáticamente" offLabel="Generar" > 
                            <p:ajax update="nif_persona" listener="#{personaGestion.cambiaNif}"/>  
                        </p:selectBooleanButton>
                    </div>
                    <div>
                        <h:outputLabel value="Nombre:"/>
                        <p:inputText required="true" label="Nombre" rendered="#{sesionActual.tienePermiso(4)}" id="nombre_persona" styleClass="valor" value="#{personaGestion.personaSeleccionada.nombre}" >
                            <f:ajax event="change" render="nombre_persona"/> 
                        </p:inputText>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.nombre}"/>
                        <h:outputLabel value="Apellido 1:"/>
                        <p:inputText label="Apellido 1" id="apellido1_persona" rendered="#{sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.apellido1}" >
                            <f:ajax event="change" render="apellido1_persona"/> 
                        </p:inputText>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.apellido1}"/>

                        <h:outputLabel value="Apellido 2:"/>
                        <p:inputText label="Nombre" id="apellido2_persona" styleClass="valor" rendered="#{sesionActual.tienePermiso(4)}" value="#{personaGestion.personaSeleccionada.apellido2}">
                            <f:ajax event="change" render="apellido2_persona"/> 
                        </p:inputText>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.apellido2}"/>
                    </div>
                    <div>
                        <h:outputLabel value="Número S.S.:"/>
                        <p:inputText validator="#{validarVista.validaNSS}" rendered="#{sesionActual.tienePermiso(4)}" label="Número S.S." id="nss_persona" styleClass="valor valorTextoNSS" value="#{personaGestion.personaSeleccionada.nss}" >
                            <f:ajax event="change" render="nss_persona"/> 
                        </p:inputText>
                        <p:commandButton rendered="#{sesionActual.tienePermiso(4)}" onclick="$('.valorTextoNSS').val(aniadeNSS(prompt('Introduzca el NSS a ser rellenado:', ''), $('.valorTextoNSS').val()));$('.valorTextoNSS').change();
                            return false;" type="button"  ajax="true" icon="ui-icon-arrowrefresh-1-s" styleClass="separador" title="Calcular dígito control NSS"  />
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.nss}"/>
                        <h:outputLabel value="Email:"/>
                        <p:inputText validator="#{validarVista.validaEmail}" rendered="#{sesionActual.tienePermiso(4)}"  label="Email" id="email_persona" styleClass="valor" value="#{personaGestion.personaSeleccionada.email}">
                            <f:ajax event="change" render="email_persona"/> 
                        </p:inputText>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.email}"/>

                        <h:outputLabel value="Fecha de Nac.:"/>
                        <p:calendar rendered="#{sesionActual.tienePermiso(4)}" lang="es" label="Fecha de Nacimiento" navigator="true"  showOn="button" id="fnac_persona" styleClass="valor" value="#{personaGestion.personaSeleccionada.fechaNacimiento}">
                            <f:ajax event="change" render="fnac_persona"/> 
                        </p:calendar>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{Fecha.getFechaDiaMesAnio(personaGestion.personaSeleccionada.fechaNacimiento)}"/>
                        <p:selectBooleanButton id="btfnp" onLabel="Fecha de Nac. Inventada" offLabel="Fecha de Nac. Real"
                                               value="#{personaGestion.personaSeleccionada.alumno.fnac_inventada}"
                                               rendered="#{personaGestion.esAlumno and sesionActual.tienePermiso(4)}"
                                               >
                            <f:ajax event="change" render="btfnp"/> 
                        </p:selectBooleanButton>
                        <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{(personaGestion.personaSeleccionada.alumno.fnac_inventada)?'(Inventada)':''}"/>
                    </div>
                    <div>
                        <h:outputLabel value="Dirección:"/>
                        <h:outputLabel styleClass="valor" id="texto_direccion" value="
                                       #{personaGestion.personaSeleccionada.direccion.tipoVia.abreviatura} 
                                       #{personaGestion.personaSeleccionada.direccion.via} #{personaGestion.personaSeleccionada.direccion.numero} #{personaGestion.personaSeleccionada.direccion.extra}, #{personaGestion.personaSeleccionada.direccion.cpLocalidad.cpLocalidadPK.cp} 
                                       #{personaGestion.personaSeleccionada.direccion.cpLocalidad.localidad1.nombre} (#{personaGestion.personaSeleccionada.direccion.cpLocalidad.localidad1.provincia.nombre})"/>
                        <p:commandButton rendered="#{sesionActual.tienePermiso(4)}" icon="ui-icon-search" title="Cambiar Dirección" type="button" onclick="dlgDireccion.show()" styleClass="separador" />
                        <p:outputPanel rendered="#{personaGestion.personaSeleccionada.usuario ne null}" style="margin-left: 10px;">
                            <h:outputLabel value="Usuario:"/>
                            <h:outputLabel styleClass="valor" value="#{personaGestion.personaSeleccionada.usuario.usuario}"/>
                            <p:button icon="ui-icon-search" title="Ver usuario" href="../usuario/usuario.xhtml?usuario=#{personaGestion.personaSeleccionada.nif}"  styleClass="separador" />
                        </p:outputPanel>
                    </div>
                    <div>
                        <p:dataTable  filterEvent="change" editable="true" var="t" value="#{personaGestion.personaSeleccionada.personaTelefonoList}" style="width: 250px; margin: auto;"
                                      emptyMessage="La persona no tiene Teléfonos asociados"
                                      >
                            <f:facet name="header">  
                                Teléfonos de la Persona
                                <p:commandButton icon="ui-icon-plus" rendered="#{sesionActual.tienePermiso(4)}" style="width:16px; height: 16px;" update=":formulario_principal" immediate="true" actionListener="#{personaGestion.aniadirTelefono}" />
                            </f:facet>  
                            <p:column headerText="Teléfono">  
                                <p:cellEditor>  
                                    <f:facet name="output">  
                                        <h:outputText value="#{t.personaTelefonoPK.numero}" />  
                                    </f:facet>  
                                    <f:facet name="input">  
                                        <p:inputText rendered="#{t.grupoList eq null or t.grupoList.size() eq 0}" value="#{t.personaTelefonoPK.numero}" validator="#{validarVista.validaTelefono}"  onfocus="borraCeros($(this));">
                                            <f:ajax event="change" render=":formulario_principal:messages :formulario_principal:growl"/> 
                                        </p:inputText>  
                                        <h:outputText rendered="#{not (t.grupoList eq null or t.grupoList.size() eq 0)}" value="#{t.personaTelefonoPK.numero}" /> 
                                    </f:facet>  
                                </p:cellEditor>  
                            </p:column>
                            <p:column headerText="Tipo" style="width:125px" >  
                                <p:cellEditor>  
                                    <f:facet name="output">  
                                        <h:outputText value="#{t.tipo.nombre}" />  
                                    </f:facet>  
                                    <f:facet name="input">  
                                        <p:selectOneMenu style="width:100px;" value="#{t.tipo}" >  
                                            <f:selectItems value="#{desplegableVista.tiposTelefono}"  
                                                           var="ti"   
                                                           itemLabel="#{ti.nombre}"  
                                                           itemValue="#{ti}" />  
                                        </p:selectOneMenu>  
                                    </f:facet>  
                                </p:cellEditor> 
                            </p:column>
                            <p:column style="width:70px" rendered="#{sesionActual.tienePermiso(4)}">  
                                <p style="width:70px; padding: 0px; margin: 0px;">
                                    <p:rowEditor  /> 
                                    <p:commandButton icon="ui-icon-trash" style="width:17px; height: 17px;" onclick="dlgEliminarTelefono.show();"  rendered="#{t.grupoList eq null or t.grupoList.size() eq 0}"  process="@this" >
                                        <f:setPropertyActionListener value="#{t}"  
                                                                     target="#{personaGestion.telefonoSeleccionado}" /> 
                                    </p:commandButton>
                                </p>
                            </p:column> 
                        </p:dataTable>
                    </div>
                    <div>
                        <p:dataTable  filterEvent="change" var="empresa" value="#{personaGestion.personaSeleccionada.empresaList}" style="width: 500px; margin: 10px auto;"
                                      emptyMessage="La persona no tiene Empresas asociadas"
                                      id="tabla_empresa_asociado"
                                      >
                            <f:facet name="header">  
                                Empresas asociadas a Persona
                                <p:commandButton icon="ui-icon-plus" style="width:16px; height: 16px;" onclick="dlgAniadirEmpresa.show();" rendered="#{sesionActual.tienePermiso(4)}" />
                            </f:facet>  
                            <p:column id="c_tipo_empresa"  
                                      headerText="Tipo" 
                                      >  
                                <h:outputText value="#{empresa.empresaMatricula ne null and empresa.proveedor ne null ? 'Mat.+Prov.' : 
                                                       (empresa.empresaMatricula ne null? 'Matricular' : (empresa.proveedor ne null)? 'Proveedor' : 'Empresa') }"  />  
                            </p:column> 
                            <p:column id="c_estado" headerText="Estado" > 
                                <h:outputText value="#{empresa.estado.nombre}" /> 
                            </p:column>
                            <p:column id="c_empresa_nif" headerText="NIF">  
                                <h:outputText value="#{empresa.nif}" /> 
                            </p:column>
                            <p:column id="c_razon_social" headerText="Razón Social" >  
                                <h:outputText value="#{empresa.razonSocial}" /> 
                            </p:column>

                            <p:column style="width:80px;">  
                                <p:button icon="ui-icon-search" href="../empresa/empresa.xhtml?empresa=#{empresa.nif}"  process="@this" />
                                <p:commandButton rendered="#{sesionActual.tienePermiso(4)}" icon="ui-icon-trash" onclick="dlgEliminarEmpresa.show();" >
                                    <f:setPropertyActionListener value="#{empresa}"  
                                                                 target="#{personaGestion.empresaSeleccionada}" /> 
                                </p:commandButton>
                            </p:column> 
                        </p:dataTable>
                        <p:dataTable  filterEvent="change" rendered="#{personaGestion.personaSeleccionada.empresaList1.size() gt 0}" var="empresa" value="#{personaGestion.personaSeleccionada.empresaList1}" style="width: 500px; margin: 10px auto; margin-top: 30px;"
                                      emptyMessage="La persona no tiene Empresas asociadas"
                                      id="tabla_empresa_rl_asociado"
                                      >
                            <f:facet name="header">  
                                Empresas de las que la Persona es Representante Legal
                            </f:facet>  
                            <p:column id="c_tipo_empresa"  
                                      headerText="Tipo" 
                                      >  
                                <h:outputText value="#{empresa.empresaMatricula ne null and empresa.proveedor ne null ? 'Mat.+Prov.' : 
                                                       (empresa.empresaMatricula ne null? 'Matricular' : (empresa.proveedor ne null)? 'Proveedor' : 'Empresa') }"  />  
                            </p:column> 
                            <p:column id="c_estado" headerText="Estado" > 
                                <h:outputText value="#{empresa.estado.nombre}" /> 
                            </p:column>
                            <p:column id="c_empresa_nif" headerText="NIF">  
                                <h:outputText value="#{empresa.nif}" /> 
                            </p:column>
                            <p:column id="c_razon_social" headerText="Razón Social" >  
                                <h:outputText value="#{empresa.razonSocial}" /> 
                            </p:column>

                            <p:column style="width:4%">  
                                <p:button icon="ui-icon-search" href="../empresa/empresa.xhtml?empresa=#{empresa.nif}" />
                            </p:column> 
                        </p:dataTable>
                    </div>
                </p:fieldset>
                <p:fieldset collapsed="#{personaGestion.borrado}" legend="Datos de Alumno" styleClass="campoRellena" id="datosAlumno" rendered="#{personaGestion.esAlumno}" toggleable="true">
                    <div style="float: right; min-width: 440px;">
                        <div>
                            <p:selectBooleanButton style="float: right; margin: 0px 5px;" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp" onLabel="Autónomo" offLabel="Asalariado" value="#{personaGestion.personaSeleccionada.alumno.autonomo}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                            <p:selectBooleanButton style="float: right; margin: 0px 5px;" onLabel="Discapacitado" offLabel="No es Discapacitado" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp"  value="#{personaGestion.personaSeleccionada.alumno.discapacitado}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                            <p:selectBooleanButton style="float: right; margin: 0px 5px;" onLabel="Víctima de Terrorismo" offLabel="No es Víctima de Terrorismo" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp"  value="#{personaGestion.personaSeleccionada.alumno.victimaTerrorismo}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                            <p:selectBooleanButton style="float: right; margin: 0px 5px;" onLabel="Víctima de Violencia de Género" offLabel="No es Víctima de Violencia de Género" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp"  value="#{personaGestion.personaSeleccionada.alumno.victimaVG}">
                                <f:ajax event="change" render="formulario_principal"/> 
                            </p:selectBooleanButton>
                        </div>
                    </div>
                    <div style="float: left; margin-top: 30px;width:100%;">
                        <div>
                            <h:outputLabel value="Nivel de Estudios: " style="width: 200px;display: inline-block;text-align: right; margin-right: 5px; margin-left: 10px;"/>
                            <p:selectOneMenu  rendered="#{sesionActual.tienePermiso(4)}" style="text-align: left;width: 500px;" value="#{personaGestion.personaSeleccionada.alumno.nivelEstudios}">
                                <f:selectItem itemLabel="" itemValue="" /> 
                                <f:selectItems value="#{desplegableVista.nivelEstudios}" var="c" itemValue="#{c}" itemLabel="#{c.nombre}" />
                                <f:ajax />
                            </p:selectOneMenu>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.alumno.nivelEstudios.nombre}"/>
                            <p:selectBooleanButton  style="vertical-align: top;margin-left: 20px;" id="nvinv" onLabel="Nivel de Estudios Inventado" offLabel="Nivel de Estudios Real" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp" 
                                                    value="#{personaGestion.personaSeleccionada.alumno.nivel_estidios_inventado}"
                                                    rendered="#{personaGestion.esAlumno}"
                                                    >
                                <f:ajax event="change" render="nvinv"/> 
                            </p:selectBooleanButton>
                        </div>
                        <div>
                            <h:outputLabel value="Grupo Cotización: " style="width: 200px;display: inline-block;text-align: right; margin-right: 5px; margin-left: 10px;"/>
                            <p:selectOneMenu rendered="#{sesionActual.tienePermiso(4)}" style="text-align: left;width: 500px;" value="#{personaGestion.personaSeleccionada.alumno.grupoCotizacion}">
                                <f:selectItem itemLabel="" itemValue="" /> 
                                <f:selectItems value="#{desplegableVista.grupoCotizacion}" var="c" itemValue="#{c}" itemLabel="(#{c.id}) #{c.nombre}" />
                                <f:ajax />
                            </p:selectOneMenu>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="(#{personaGestion.personaSeleccionada.alumno.grupoCotizacion.id}) #{personaGestion.personaSeleccionada.alumno.grupoCotizacion.nombre}"/>
                            <p:selectBooleanButton style="vertical-align: top;margin-left: 20px;" id="gcinv" onLabel="Grupo Cotización Inventado" offLabel="Grupo Cotización Real" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp" 
                                                   value="#{personaGestion.personaSeleccionada.alumno.grupo_cotizacion_inventado}"
                                                   rendered="#{personaGestion.esAlumno}"
                                                   >
                                <f:ajax event="change" render="gcinv"/> 
                            </p:selectBooleanButton>
                        </div>
                        <div>
                            <h:outputLabel value="Área Funcional: " style="width: 200px;display: inline-block;text-align: right; margin-right: 5px; margin-left: 10px;"/>
                            <p:selectOneMenu rendered="#{sesionActual.tienePermiso(4)}" style="text-align: left;width: 500px;" value="#{personaGestion.personaSeleccionada.alumno.areaFuncional}">
                                <f:selectItem itemLabel="" itemValue="" /> 
                                <f:selectItems value="#{desplegableVista.areaFuncional}" var="c" itemValue="#{c}" itemLabel="#{c.nombre}" />
                                <f:ajax />
                            </p:selectOneMenu>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.alumno.areaFuncional.nombre}"/>
                            <p:selectBooleanButton style="vertical-align: top;margin-left: 20px;" id="afinv" onLabel="Área Funcional Inventada" offLabel="Área Funcional Real" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp" 
                                                   value="#{personaGestion.personaSeleccionada.alumno.area_funcional_inventada}"
                                                   rendered="#{personaGestion.esAlumno}"
                                                   >
                                <f:ajax event="change" render="afinv"/> 
                            </p:selectBooleanButton>
                        </div>
                        <div>
                            <h:outputLabel value="Categoría Profesional: " style="width: 200px;display: inline-block;text-align: right; margin-right: 5px; margin-left: 10px;"/>
                            <p:selectOneMenu  rendered="#{sesionActual.tienePermiso(4)}" style="text-align: left; width: 500px;" value="#{personaGestion.personaSeleccionada.alumno.categoriaProfesional}">
                                <f:selectItem itemLabel="" itemValue="" /> 
                                <f:selectItems value="#{desplegableVista.categoriaProfesional}" var="c" itemValue="#{c}" itemLabel="#{c.nombre}" />
                                <f:ajax />
                            </p:selectOneMenu>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.alumno.categoriaProfesional.nombre}"/>
                            <p:selectBooleanButton style="vertical-align: top;margin-left: 20px;" id="cpinv" onLabel="Categoría Profesional Inventada" offLabel="Categoría Profesional Real" disabled="#{not sesionActual.tienePermiso(4)}" styleClass="noTransp" 
                                                   value="#{personaGestion.personaSeleccionada.alumno.categoria_profesional_inventada}"
                                                   rendered="#{personaGestion.esAlumno}"
                                                   >
                                <f:ajax event="change" render="cpinv"/> 
                            </p:selectBooleanButton>

                        </div>
                        <div>
                            <h:outputLabel value="Otras Titulaciones: " style="width: 200px;display: inline-block;text-align: right; margin-right: 5px; margin-left: 10px;"/>
                            <p:inputText rendered="#{sesionActual.tienePermiso(4)}" style="text-align: left; width: 600px;" id="otras_tit" styleClass="valor" value="#{personaGestion.personaSeleccionada.alumno.otrasTitulaciones}">
                                <f:ajax event="change" render="otras_tit"/> 
                                <f:ajax />
                            </p:inputText>
                            <p:outputLabel rendered="#{not sesionActual.tienePermiso(4)}" styleClass="valor" value="#{personaGestion.personaSeleccionada.alumno.otrasTitulaciones}"/>

                        </div>
                        <div style="width: 500px; margin: auto;">
                            <h:outputLabel value="Observaciones: " />
                            <p:editor value="#{personaGestion.personaSeleccionada.alumno.observaciones}" styleClass="noTransp"  disabled="#{not sesionActual.tienePermiso(4)}">
       
                            </p:editor>
                        </div>
                        <div>
                            <p:dataTable  filterEvent="change" var="matricula" value="#{personaGestion.personaSeleccionada.alumno.matriculaList}" style="width: 500px; margin: 10px auto;"
                                          emptyMessage="El alumno no tiene Matrículas asociadas"
                                          id="tabla_matriculas_asociadas"
                                          >
                                <f:facet name="header">  
                                    Matrículas asociadas a Alumno
                                </f:facet>  
                                <p:column headerText="Identificador" >  
                                    <h:outputText value="#{matricula.id}" /> 
                                </p:column>
                                <p:column headerText="Acción Formativa" >  
                                    <h:outputText value="#{matricula.grupo.accionFormativa1.id} #{matricula.grupo.accionFormativa1.nombre}" /> 
                                </p:column>
                                <p:column headerText="Grupo" >  
                                    <h:outputText value="#{matricula.grupo.nombre}" /> 
                                </p:column>
                                <p:column headerText="F. Inicio" >  
                                    <h:outputText value="#{Fecha.getFechaDiaMesAnio(matricula.grupo.FInicio)}" /> 
                                </p:column>
                                <p:column headerText="F. Fin" >  
                                    <h:outputText value="#{Fecha.getFechaDiaMesAnio(matricula.grupo.FFin)}" /> 
                                </p:column>
                                <p:column>  
                                    <p:button icon="ui-icon-search" href="../matricula/matricula.xhtml?matricula=#{matricula.id}" />

                                </p:column> 
                            </p:dataTable>

                        </div>
                    </div>
                </p:fieldset>
                <p:fieldset collapsed="#{personaGestion.borrado}" legend="Datos de Tutor" styleClass="campoRellena" id="datosTutor" rendered="#{personaGestion.esTutor}" toggleable="true">
                    <div>    
                        <h:outputLabel value="Proveedor de tutorías:"/>
                        <a href="../empresa/empresa.xhtml?empresa=#{personaGestion.personaSeleccionada.tutor.empresa.nif}" target="_blank"><h:outputLabel styleClass="valor" id="proveedor_tutor" value="
                                                                                                                                                          #{personaGestion.personaSeleccionada.tutor.empresa.razonSocial} (#{personaGestion.personaSeleccionada.tutor.empresa.nif})"/>
                        </a>
                        <p:commandButton icon="ui-icon-search" title="Cambiar Proveedor" rendered="#{sesionActual.tienePermiso(4)}" type="button" onclick="dlgProveedor.show()" styleClass="separador" />
                    </div>
                    <div>
                        <p:dataTable  filterEvent="change" var="grupo" value="#{personaGestion.personaSeleccionada.tutor.grupoList}" style="width: 500px; margin: 10px auto;"
                                      emptyMessage="El tutor no tiene Grupos asociados"
                                      id="tabla_grupos_asociados"
                                      paginator="true" rows="5"    
                                      paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                      currentPageReportTemplate="{totalRecords} Filas (página {currentPage} de {totalPages})"
                                      rowsPerPageTemplate="5,10,15,25,50,100, 300"
                                      sortBy="#{grupo.FInicio}" sortOrder="descending"
                                      >
                            <f:facet name="header">  
                                Grupos asociados a Tutor
                            </f:facet>  
                            <p:column headerText="Acción Formativa"  filterMatchMode="contains"
                                      sortBy="#{grupo.accionFormativa1.nombre}" filterBy="#{grupo.accionFormativa1.nombre}"
                                      >  
                                <h:outputText value="#{grupo.accionFormativa1.nombre}" /> 
                            </p:column>
                            <p:column headerText="Grupo"  filterMatchMode="contains"
                                      sortBy="#{grupo.nombre}" filterBy="#{grupo.nombre}"
                                      >  
                                <h:outputText value="#{grupo.nombre}" /> 
                            </p:column>
                            <p:column headerText="F. Inicio" filterStyleClass="calendarFilter" filterMatchMode="contains"
                                      sortBy="#{grupo.FInicio}" filterBy="#{grupo.FInicio}"
                                      >  
                                <h:outputText value="#{Fecha.getFechaDiaMesAnio(grupo.FInicio)}" /> 
                            </p:column>
                            <p:column headerText="F. Fin" filterStyleClass="calendarFilter" filterMatchMode="contains"
                                      sortBy="#{grupo.FFin}" filterBy="#{grupo.FFin}"
                                      >  
                                <h:outputText value="#{Fecha.getFechaDiaMesAnio(grupo.FFin)}" /> 
                            </p:column>
                            <p:column >  
                                <p:button icon="ui-icon-search" href="../grupo/grupo.xhtml?grupo=#{grupo.grupoPK.id}&amp;accionformativa=#{grupo.grupoPK.accionFormativa}" />

                            </p:column> 
                        </p:dataTable>

                    </div>
                </p:fieldset>

                <p:fieldset rendered="#{personaGestion.esTutor}" toggleable="#{not (personaGestion.borrado or personaGestion.modoAlta)}" collapsed="#{personaGestion.borrado or personaGestion.modoAlta}" legend="Eventos" styleClass="campoRellena" id="eventos">
                    <div style="text-align: right;">
                        <p:commandButton value="Ausencia" onclick="dlgDetalleNuevoEventoBoton.show();" update="" rendered="#{sesionActual.tienePermiso(4)}">
                        </p:commandButton> 
                    </div>
                    <p:dataTable  filterEvent="change" value="#{personaGestion.personaSeleccionada.tutor.eventoList}" var="evento"
                                  sortBy="#{evento.fechaCreacion}" sortOrder="descending"
                                  emptyMessage="No existen eventos asociados al Tutor"
                                  paginator="true" rows="5"    
                                  paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                  currentPageReportTemplate="{totalRecords} Filas (página {currentPage} de {totalPages})"
                                  rowsPerPageTemplate="5,10,15,25,50,100, 300"
                                  >
                        <p:column headerText="Descripción" filterMatchMode="contains"
                                  sortBy="#{evento.descripcion}" filterBy="#{evento.descripcion}"
                                  >
                            <p:outputLabel value="#{evento.descripcion}"/>
                        </p:column>
                        <p:column headerText="Estado" filterMatchMode="contains"
                                  sortBy="#{evento.estadoLargo}" filterBy="#{evento.estadoLargo}">
                            <p:outputLabel value="#{evento.estadoLargo}"/>
                        </p:column>
                        <p:column headerText="Fecha de Creación" filterStyleClass="calendarFilter" filterMatchMode="contains"
                                  sortBy="#{evento.fechaCreacion}" filterBy="#{evento.fechaCreacion}">
                            <p:outputLabel value="#{Fecha.getFechaDiaMesAnio(evento.fechaCreacion)}"/>
                        </p:column>
                        <p:column headerText="Fecha de Realización" filterStyleClass="calendarFilter" filterMatchMode="contains"
                                  sortBy="#{evento.fechaRealizacion}" filterBy="#{evento.fechaRealizacion}">
                            <p:outputLabel value="#{Fecha.getFechaDiaMesAnio(evento.fechaRealizacion)}"/>
                        </p:column>
                        <p:column headerText="Fecha de Vencimiento" filterStyleClass="calendarFilter" filterMatchMode="contains"
                                  sortBy="#{evento.fechaVencimiento}" filterBy="#{evento.fechaVencimiento}">
                            <p:outputLabel value="#{Fecha.getFechaDiaMesAnio(evento.fechaVencimiento)}"/>
                        </p:column>
                        <p:column style="width:4%">  
                            <p:commandButton process="@this" id="selectButtonVer" update=":detalles_de_evento" title="Ver" icon="ui-icon-search" oncomplete="dlgDetalleEvento.show();" styleClass="#{(evento.observaciones eq null or evento.observaciones eq '') ? '' : 'greenyellow'}" >
                                <f:setPropertyActionListener target="#{controlCalendario.eventId}" value="#{evento.id}"/>
                            </p:commandButton>   
                        </p:column>
                    </p:dataTable>
                </p:fieldset>
                <p:fieldset rendered="#{personaGestion.personaSeleccionada.comercial ne null}" collapsed="#{personaGestion.borrado}" legend="Estructura Comercial" styleClass="campoRellena" id="estructuraComercial" toggleable="true">
                    <p style="text-align: center; font-weight: bolder;">#{personaGestion.personaSeleccionada.comercial.comercialTipo.nombre} - #{personaGestion.personaSeleccionada.comercial.comercialSuperior.comercialTipo.nombre}: #{personaGestion.personaSeleccionada.comercial.nombreSuperior}</p>
                    <p:commandButton styleClass="botonAplicar" value="Asociar Estructura Comercial" onclick="dlgNuevoComercial.show()" type="button" rendered="#{sesionActual.tienePermiso(4)}" /> 
                </p:fieldset>

                <div style="text-align: center;">
                    <p:commandButton value="Asociar Estructura Comercial" rendered="#{personaGestion.personaSeleccionada.comercial eq null and sesionActual.tienePermiso(4)}" onclick="dlgNuevoComercial.show()"/> 
                </div>

                <p:commandButton rendered="#{sesionActual.tienePermiso(4)}" disabled="#{personaGestion.borrado}" id="botonGuarda" actionListener="#{personaGestion.guarda}" value="Guardar" icon="ui-icon-check" update="messages growl" styleClass="botonAplicar" process="formulario_principal"/> 
                <p:commandButton value="#{personaGestion.vieneDesdeMatricula?'Volver a Matrícula':'Salir'}" icon="#{personaGestion.vieneDesdeMatricula?'ui-icon ui-icon-arrowreturnthick-1-w':'ui-icon ui-icon-arrowreturn-1-w'}"
                                 immediate="#{personaGestion.vieneDesdeMatricula}"
                                 onclick="#{personaGestion.vieneDesdeMatricula?validarVista.volverMatricula(personaGestion.matID):'confirmation.show()'}" styleClass="botonAplicar"/>

                <p:commandButton rendered="#{sesionActual.tienePermiso(6)}" id="botonBorrado" disabled="#{personaGestion.borrado or personaGestion.modoAlta}" style="float: left; " value="Eliminar"  icon="ui-icon-trash" onclick="confirmationEliminar.show()" styleClass="botonAplicar bg-red"/>  
                <p:commandButton rendered="#{sesionActual.tienePermiso(6)}" actionListener="#{personaGestion.elimina}" update="messages growl botonGuarda botonBorrado formulario_principal" styleClass="boton_borrar_objeto"/> 
            </c:if>
        </ui:define>

        <ui:define name="dialogos">
            <c:if test="#{not personaGestion.esRepNoEx}">
                <p:confirmDialog header="Ausencia"  rendered="#{sesionActual.tienePermiso(4)}" widgetVar="dlgDetalleNuevoEventoBoton" message="Introduzca la fecha:" >
                    <h:form id="aniadir_evento_boton">
                        <p>
                            <p:calendar id="calNuevoEventoboton" styleClass="botonAplicar" navigator="true" value="#{personaGestion.fechaNuevoEvento}" >
                                <f:ajax event="dateSelect" render="calNuevoEventoboton calNuevoEventobotonHasta"/> 
                            </p:calendar>
                            <p:outputLabel value="Ausencia Desde:&nbsp;" style="float:right;"/>
                            <br/><br/>
                            <p:calendar id="calNuevoEventobotonHasta" styleClass="botonAplicar" navigator="true" value="#{personaGestion.fechaNuevoEventoHasta}" mindate="#{personaGestion.fechaNuevoEvento}" >
                                <f:ajax event="dateSelect" render="calNuevoEventoboton calNuevoEventobotonHasta"/> 
                            </p:calendar>
                            <p:outputLabel value="Ausencia Hasta:&nbsp;" style="float:right;"/>
                        </p><br/><br/>
                        <p:commandButton actionListener="#{personaGestion.nuevoEvento}" styleClass="botonAplicar" value="Guardar" style="margin: 0px 10px;" ajax="false" update="calNuevoEventoboton calNuevoEventobotonHasta"/>

                    </h:form>
                </p:confirmDialog>

                <p:dialog header="Seleccionar Proveedor" widgetVar="dlgProveedor" resizable="true"  rendered="#{sesionActual.tienePermiso(4)}">
                    <h:form id="seleccionar_proveedor">
                        <p:dataTable  filterEvent="change" var="proveedor" value="#{personaGestion.proveedoresPersona}" filteredValue="#{personaGestion.proveedoresPersonaFiltrados}"
                                      emptyMessage="No existen Proveedores con los criterios seleccionados."
                                      style="width:500px; margin: 5px auto;"
                                      paginator="true"
                                      rows="5" 
                                      paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                      rowsPerPageTemplate="5,10,15,30"
                                      paginatorPosition="top"
                                      >
                            <p:column id="c_nif" filterBy="#{proveedor.nif}" sortBy="#{proveedor.nif}"
                                      headerText="NIF"  
                                      filterMatchMode="contains" >  
                                <h:outputText value="#{proveedor.nif}" /> 
                            </p:column>
                            <p:column id="c_nombre" filterBy="#{proveedor.empresa.razonSocial}" sortBy="#{proveedor.empresa.razonSocial}"
                                      headerText="Razón Social"  
                                      filterMatchMode="contains" >  
                                <h:outputText value="#{proveedor.empresa.razonSocial}" /> 
                            </p:column>
                            <p:column style="width:10px;">  
                                <p:commandButton id="select_empresa" onclick="dlgProveedors.close()" icon="ui-icon-check" title="Seleccionar" ajax="true" update=":formulario_principal:proveedor_tutor">  
                                    <f:setPropertyActionListener value="#{proveedor.empresa}" target="#{personaGestion.personaSeleccionada.tutor.empresa}" />  
                                </p:commandButton>  
                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:dialog>
                <p:dialog header="Añadir Empresa" widgetVar="dlgAniadirEmpresa" resizable="true" rendered="#{sesionActual.tienePermiso(4)}">
                    <h:form id="aniadir_persona_empresa">
                        <p:dataTable  filterEvent="change" var="empresa" value="#{empresaVista.empresas}" filteredValue="#{empresaVista.empresasFiltradas}" lazy="true"
                                      emptyMessage="No existen Empresas con los criterios seleccionados."
                                      style="width:500px; margin: 5px auto;"
                                      paginator="true"
                                      rows="5" 
                                      paginatorTemplate="{PreviousPageLink} {NextPageLink} {RowsPerPageDropdown}"  
                                      rowsPerPageTemplate="5,10,15,30"
                                      paginatorPosition="top"
                                      >
                            <p:column id="c_tipo_empresa" filterBy="#{empresa.tipo }"   
                                      headerText="Tipo" 
                                      sortBy="#{empresa.tipo }"

                                      filterOptions="#{desplegableVista.tipoEmpresaOptions}"  
                                      filterMatchMode="exact" style="text-align: center;">  
                                <h:outputText value="#{empresa.tipo }"  />  
                            </p:column> 
                            <p:column id="c_nif" filterBy="#{empresa.nif}" sortBy="#{empresa.nif}"
                                      headerText="NIF"  
                                      filterMatchMode="contains" >  
                                <h:outputText value="#{empresa.nif}" /> 
                            </p:column>
                            <p:column id="c_nombre" filterBy="#{empresa.razonSocial}" sortBy="#{empresa.razonSocial}"
                                      headerText="Razón Social"  
                                      filterMatchMode="contains" >  
                                <h:outputText value="#{empresa.razonSocial}" /> 
                            </p:column>
                            <p:column style="width:10px;">  
                                <p:commandButton id="select_empresa" onclick="dlgAniadirEmpresa.close()" icon="ui-icon-check" title="Seleccionar" ajax="true" update=":formulario_principal:tabla_empresa_asociado">  
                                    <f:setPropertyActionListener value="#{empresa.empresa}" target="#{personaGestion.aniadirEmpresa}" />  
                                </p:commandButton>  
                            </p:column>
                        </p:dataTable>
                    </h:form>
                </p:dialog>
                <!--COMIENZA ASOCIACION ESTRUCTURA COMERCIAL-->
                <p:dialog modal="true" header="Asociar Estructura Comercial"  rendered="#{sesionActual.tienePermiso(4)}" widgetVar="dlgNuevoComercial"  resizable="true" visible="#{personaGestion.abrirASEC}">
                    <h:form id="estructuracomercialdialog1">
                        <p >Nivel Superior: #{personaGestion.comerc.nombreSuperior} <p:commandButton icon="ui-icon-search" title="Asociar Nivel Superior" type="button" onclick="dlgAsociaComercialSuperior.show()" styleClass="separador" /></p>

                        <h:outputLabel value="Tipo Nivel: " ><p:selectOneMenu value="#{personaGestion.comerc.comercialTipo}" id="comercialTipoSeleccionar" >
                                <f:selectItems value="#{personaGestion.ctip}" var="c" itemValue="#{c}" itemLabel="#{c.nombre}" />
                                <p:ajax event="change" process="@this" global="false"/>
                            </p:selectOneMenu>
                            <p:commandButton icon="ui-icon-plus" title="Nuevo Tipo" rendered="#{sesionActual.tienePermiso(21)}" type="button" onclick="dlgNuevoTipoComercial.show()" style="top: -7px;left: 6px;" />

                        </h:outputLabel>
                        <br/>
                        <p:commandButton value="Guardar" styleClass="botonAplicar" actionListener="#{personaGestion.asociaEC}" ajax="false"/>
                    </h:form>
                </p:dialog> 
                <p:dialog header="Añadir Tipo Nivel" widgetVar="dlgNuevoTipoComercial" resizable="true"  rendered="#{sesionActual.tienePermiso(21)}">
                    <h:form id="estructuracomercialdialog2">
                        <p:outputLabel value="Nombre de Nuevo Tipo Nivel: "/>
                        <p:inputText value="#{personaGestion.nombreNuevoTipoComercial}"/>
                        <br/><br/>
                        <p:commandButton actionListener="#{personaGestion.guardaNuevoTipoComercial}"  onclick="dlgNuevoTipoComercial.close();"  value="Guardar" icon="ui-icon-check" update=":formulario_principal:messages :formulario_principal:growl :estructuracomercialdialog1:comercialTipoSeleccionar" styleClass="botonAplicar"/> 

                    </h:form>
                </p:dialog>
                <p:dialog header="Asociar Nivel Superior"  rendered="#{sesionActual.tienePermiso(4)}" widgetVar="dlgAsociaComercialSuperior" resizable="true">
                    <h:form id="estructuracomercialdialog3">
                        <p:dataTable  filterEvent="change" value="#{personaGestion.comerciales}" var="com" filteredValue="#{personaGestion.comercialesFiltrados}"
                                      emptyMessage="No existen Comerciales con los criterios seleccionados."
                                      style="width:500px; margin: 5px auto;"
                                      paginator="true"
                                      rows="5" 
                                      paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"  
                                      rowsPerPageTemplate="5,10,15,30"
                                      paginatorPosition="top">
                            <p:column filterBy="#{com.nombre}" filterMatchMode="contains" headerText="Nombre">#{com.nombre}</p:column>
                            <p:column filterBy="#{com.nombreSuperior}" filterMatchMode="contains" headerText="Superior">#{com.nombreSuperior}</p:column>
                            <p:column filterBy="#{com.comercialTipo.nombre}" filterMatchMode="contains" headerText="Tipo">#{com.comercialTipo.nombre}</p:column>
                            <p:column style="width:10px;">  
                                <p:commandButton id="select_com" onclick="dlgAsociaComercialSuperior.close()" icon="ui-icon-check" title="Seleccionar" ajax="true" update=":estructuracomercialdialog1">  
                                    <f:setPropertyActionListener value="#{com}" target="#{personaGestion.comerc.comercialSuperior}" /> 
                                    <f:setPropertyActionListener value="true" target="#{personaGestion.abrirASEC}" />  
                                </p:commandButton>  
                            </p:column>

                        </p:dataTable>
                        <p:commandButton styleClass="botonAplicar" id="select_nocom" onclick="dlgAsociaComercialSuperior.close()" value="Sin nivel superior" title="Seleccionar" ajax="true" update=":estructuracomercialdialog1">  
                            <f:setPropertyActionListener value="#{null}" target="#{personaGestion.comerc.comercialSuperior}" /> 
                            <f:setPropertyActionListener value="true" target="#{personaGestion.abrirASEC}" />  
                        </p:commandButton> 
                    </h:form>
                </p:dialog>
                <!--FINALIZA ASOCIACION EC-->
                <p:dialog header="Seleccionar Dirección" widgetVar="dlgDireccion" resizable="true" rendered="#{sesionActual.tienePermiso(4)}">   
                    <h:form id="form_direccion">
                        <div class="valor">
                            <p:selectOneMenu styleClass="valor" value="#{personaGestion.personaSeleccionada.direccion.tipoVia}">
                                <f:selectItems value="#{direccionVista.tiposVia}" var="tvia" itemValue="#{tvia}" itemLabel="#{tvia.nombre}" />
                            </p:selectOneMenu>&nbsp;&nbsp;
                            <p:inputText styleClass="valor" value="#{personaGestion.personaSeleccionada.direccion.via}"/>, Número: 
                            <p:inputText styleClass="valor" value="#{personaGestion.personaSeleccionada.direccion.numero}"/>,&nbsp;
                            <p:inputText styleClass="valor" value="#{personaGestion.personaSeleccionada.direccion.extra}"/>.
                            <h:outputText id="cpl_loc" value="CP: #{personaGestion.personaSeleccionada.direccion.cpLocalidad.cpLocalidadPK.cp}, #{personaGestion.personaSeleccionada.direccion.cpLocalidad.localidad1.nombre} (#{personaGestion.personaSeleccionada.direccion.cpLocalidad.localidad1.provincia.nombre})."/>
                        </div>
                        <p:dataTable  filterEvent="change" var="cpl" value="#{direccionVista.cpLocalidades}" lazy="true"
                                      emptyMessage="No existen CP en el Sistema con los criterios seleccionados."
                                      style="width:500px; margin: 5px auto;"
                                      paginator="true"
                                      rows="5" 
                                      paginatorTemplate="{PreviousPageLink} {NextPageLink} {RowsPerPageDropdown}"  
                                      rowsPerPageTemplate="5,10,15,30"
                                      paginatorPosition="top"
                                      >
                            <f:facet name="header">  
                                Seleccionar CP
                            </f:facet>
                            <p:column headerText="CP" filterBy="#{cpl.cp}" 
                                      filterMatchMode="contains"
                                      sortBy="#{cpl.cp}"
                                      >
                                <h:outputText value="#{cpl.cp}"/>
                            </p:column>
                            <p:column headerText="Localidad" filterBy="#{cpl.localidadNombre}" 
                                      filterMatchMode="contains"
                                      sortBy="#{cpl.localidadNombre}"
                                      >
                                <h:outputText value="#{cpl.localidadNombre}"/>
                            </p:column>
                            <p:column headerText="Provincia" filterBy="#{cpl.provinciaNombre}" 
                                      filterMatchMode="exact"
                                      filterOptions="#{desplegableVista.provinciasOptions}"  
                                      sortBy="#{cpl.provinciaNombre}"
                                      >
                                <h:outputText value="#{cpl.provinciaNombre}"/>
                            </p:column>
                            <p:column style="width:10px;">  
                                <p:commandButton id="select_CP" icon="ui-icon-check" title="Seleccionar" ajax="true" update=":form_direccion">  
                                    <f:setPropertyActionListener value="#{cpl.cpLoc}" target="#{personaGestion.personaSeleccionada.direccion.cpLocalidad}" />  
                                </p:commandButton>  
                            </p:column>
                        </p:dataTable>
                        <p:commandButton id="select_direccion" styleClass="botonAplicar" onclick="dlgDireccion.close()" icon="ui-icon-check" value="Aplicar" ajax="true" update=":formulario_principal:texto_direccion">  
                        </p:commandButton>  
                        <br/><br/>
                        <hr/>
                    </h:form>
                    <h:form id="form_direccion_aniadir" rendered="false">

                    </h:form>
                </p:dialog>
                <h:form id="borrar_asociacion_empresa">
                    <p:confirmDialog id="confirmDialog" message="¿Seguro que desea eliminar la asociación con la Empresa?"  
                                     header="Borrar Asociación Persona" severity="alert" widgetVar="dlgEliminarEmpresa" rendered="#{sesionActual.tienePermiso(4)}">  

                        <p:commandButton styleClass="botonAplicar" value="Sí" update=":formulario_principal" oncomplete="dlgEliminarEmpresa.hide()"  
                                         actionListener="#{personaGestion.borrarEmpresa}" />  
                        <p:commandButton styleClass="botonAplicar" value="No" onclick="dlgEliminarEmpresa.hide()" type="button" />   

                    </p:confirmDialog> 
                </h:form>
                <h:form id="borrar_tlf">
                    <p:confirmDialog id="confirmDialog" message="¿Seguro que desea eliminar el teléfono?"   rendered="#{sesionActual.tienePermiso(4)}"
                                     header="Eliminar Teléfono" severity="alert" widgetVar="dlgEliminarTelefono">  

                        <p:commandButton styleClass="botonAplicar" value="Sí" update=":formulario_principal" oncomplete="dlgEliminarTelefono.hide()"  
                                         actionListener="#{personaGestion.borrarTelefono}" process="@this" />  
                        <p:commandButton styleClass="botonAplicar" value="No" onclick="dlgEliminarTelefono.hide()" type="button" />   

                    </p:confirmDialog> 
                </h:form>
            </c:if>
        </ui:define>

    </ui:composition>
</html>
